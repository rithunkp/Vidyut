<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Data Redaction Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Secure Data Redaction Tool</h1>
        <p>Enter your information below. After submission, sensitive data will be automatically redacted and a PDF will be generated.</p>
        
        <form id="dataForm">
            <div class="form-group">
                <label for="fullName">Full Name:</label>
                <input type="text" id="fullName" required>
            </div>
            
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" required>
            </div>
            
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone">
            </div>
            
            <div class="form-group">
                <label for="address">Address:</label>
                <textarea id="address" rows="3"></textarea>
            </div>
            
            <div class="form-group">
                <label for="idNumber">ID/Passport Number:</label>
                <input type="text" id="idNumber">
            </div>
            
            <div class="form-group">
                <label for="creditCard">Credit Card Number:</label>
                <input type="text" id="creditCard">
            </div>
            
            <button type="submit">Submit & Generate Redacted PDF</button>
        </form>
        
        <div id="results" class="hidden">
            <h2>Redacted Information</h2>
            <div id="redactedOutput"></div>
            <p>A PDF with redacted information has been generated. Check your downloads.</p>
        </div>
    </div>
    
    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;

        document.getElementById('dataForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Collect form data
            const formData = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value,
                idNumber: document.getElementById('idNumber').value,
                creditCard: document.getElementById('creditCard').value
            };
            
            // Redact sensitive data
            const redactedData = redactSensitiveData(formData);
            
            // Display redacted data
            displayRedactedData(redactedData);
            
            // Generate and download PDF
            generatePDF(redactedData);
            
            // Show results section
            document.getElementById('results').classList.remove('hidden');
        });

        function redactSensitiveData(data) {
            // Create a copy of the original data
            const redacted = {...data};
            
            // Redaction rules
            if (redacted.fullName) {
                const names = redacted.fullName.split(' ');
                if (names.length > 1) {
                    redacted.fullName = names[0] + ' ' + names[names.length - 1].charAt(0) + '.';
                }
            }
            
            if (redacted.email) {
                const [user, domain] = redacted.email.split('@');
                redacted.email = user.charAt(0) + '***' + user.slice(-1) + '@' + domain;
            }
            
            if (redacted.phone) {
                redacted.phone = redacted.phone.replace(/\d(?=\d{4})/g, '*');
            }
            
            if (redacted.address) {
                const parts = redacted.address.split(',');
                if (parts.length > 1) {
                    redacted.address = '***' + parts.slice(-2).join(',');
                } else {
                    redacted.address = '***' + redacted.address.slice(-10);
                }
            }
            
            if (redacted.idNumber) {
                redacted.idNumber = '***' + redacted.idNumber.slice(-4);
            }
            
            if (redacted.creditCard) {
                redacted.creditCard = '**** **** **** ' + redacted.creditCard.slice(-4);
            }
            
            return redacted;
        }

        function displayRedactedData(data) {
            const outputDiv = document.getElementById('redactedOutput');
            outputDiv.innerHTML = '';
            
            for (const [key, value] of Object.entries(data)) {
                const fieldDiv = document.createElement('div');
                fieldDiv.className = 'field';
                
                const label = document.createElement('strong');
                label.textContent = `${key}: `;
                
                const valueSpan = document.createElement('span');
                valueSpan.textContent = value || 'Not provided';
                
                // Add redacted class to sensitive fields
                if (key !== 'fullName') {
                    valueSpan.classList.add('redacted');
                }
                
                fieldDiv.appendChild(label);
                fieldDiv.appendChild(valueSpan);
                outputDiv.appendChild(fieldDiv);
            }
        }

        function generatePDF(data) {
            // Initialize PDF document
            const doc = new jsPDF();
            
            // Add title
            doc.setFontSize(18);
            doc.text('Redacted Personal Information', 105, 20, { align: 'center' });
            doc.setFontSize(12);
            doc.text('Generated by Secure Data Redaction Tool', 105, 30, { align: 'center' });
            
            // Add current date
            const today = new Date();
            doc.text(`Date: ${today.toLocaleDateString()}`, 14, 40);
            
            // Add a line separator
            doc.line(14, 45, 196, 45);
            
            // Prepare data for the table
            const tableData = [
                ['Field', 'Redacted Value'],
                ['Full Name', data.fullName || 'Not provided'],
                ['Email', data.email || 'Not provided'],
                ['Phone Number', data.phone || 'Not provided'],
                ['Address', data.address || 'Not provided'],
                ['ID/Passport Number', data.idNumber || 'Not provided'],
                ['Credit Card Number', data.creditCard || 'Not provided']
            ];
            
            // Add the table
            doc.autoTable({
                startY: 50,
                head: [tableData[0]],
                body: tableData.slice(1),
                theme: 'grid',
                headStyles: {
                    fillColor: [41, 128, 185],
                    textColor: 255
                },
                styles: {
                    cellPadding: 5,
                    fontSize: 10,
                    valign: 'middle'
                },
                columnStyles: {
                    0: { fontStyle: 'bold', cellWidth: 60 },
                    1: { cellWidth: 'auto' }
                }
            });
            
            
            
            // Save the PDF
            doc.save('redacted_information.pdf');
        }
    </script>
</body>
</html>